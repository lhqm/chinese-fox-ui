:root {
  /* Common */
  --cf-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --cf-font-family: "KaiTi", "STKaiti", "SimSun", "Noto Serif SC", serif;
  
  /* Layout */
  --cf-padding-base: 12px;
  --cf-padding-large: 16px;
  --cf-padding-small: 8px;
}

/* 
  Suya (素雅) - Ink Wash & Celadon Style 
  Key: Subtle, Atmospheric, Flowing, Multi-layered greys and blues
*/
:root, [data-theme="suya"] {
  /* Palette: Ink (Black/Grey), Water (White/Transparent), Mountain (Blue/Cyan) */
  --cf-color-primary: #4a6a74; /* Dai Blue (Mountain Mist) */
  --cf-color-primary-hover: #2c444e;
  --cf-color-secondary: #7f8c8d; /* Stone Grey */
  
  --cf-color-bg: #f5f7f9; /* Mist White */
  --cf-color-surface: #ffffff;
  
  --cf-color-text: #2c3e50; /* Ink Black */
  --cf-color-text-secondary: #7f8c8d;
  
  --cf-color-border: #dae1e7;
  
  /* Shadows: Soft, diffused like ink on wet paper */
  --cf-shadow: 0 4px 20px rgba(74, 106, 116, 0.08);
  --cf-shadow-hover: 0 8px 30px rgba(74, 106, 116, 0.15);
  
  --cf-border-radius: 6px;
  --cf-border-width: 1px;
  --cf-border-style: solid;
  
  /* Accents */
  /* Rice paper texture overlay */
  --cf-bg-pattern: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
  --cf-bg-size: 200px 200px;
  
  --cf-accent-decoration: none;

  --cf-svg-window-grille: url("/src/assets/窗花-黑白-左下.svg");
  --cf-svg-ink-circle: url("/src/assets/墨圈.svg");
  --cf-doc-title-icon: url("/src/assets/古风物件，中国风，文房四宝，笔，毛笔.svg");
}

/* 
  Huali (华丽) - Festive / Celebration Style
  Key: Festive Red (Big Red), Gold, Pavilions, Knots, Firecrackers.
  Concept: Low visual burden center (White/Cream), Ornate borders (Red/Gold).
*/
[data-theme="huali"] {
  /* Palette: Soft Festive Red, Imperial Gold, Cream Paper */
  /* Reduced glare: using a softer, slightly desaturated red instead of #E60012 */
  --cf-color-primary: #C23E3E; /* Soft Brick Red */
  --cf-color-primary-hover: #A93232;
  --cf-color-secondary: #E6B800; /* Muted Gold */
  
  --cf-color-bg: #FCFAF5; /* Warmer Cream */
  --cf-color-surface: #FFFFFF; 
  
  --cf-color-text: #4A1F1F; /* Softer Red-Brown */
  --cf-color-text-secondary: #8C5E5E;
  
  --cf-color-border: rgba(194, 62, 62, 0.3); /* Transparent Red Border */
  
  /* Shadows: Softer warm glow */
  --cf-shadow: 0 4px 12px rgba(194, 62, 62, 0.1);
  --cf-shadow-hover: 0 8px 24px rgba(194, 62, 62, 0.2);
  
  --cf-border-radius: 8px; 
  --cf-border-width: 1px;
  --cf-border-style: solid;
  
  /* Accents - Very subtle lattice */
  --cf-bg-pattern: 
    linear-gradient(to right, rgba(194, 62, 62, 0.02) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(194, 62, 62, 0.02) 1px, transparent 1px);
  --cf-bg-size: 24px 24px;
  
  /* Corner Decoration - Updated to use the new softer red */
  --cf-corner-pattern: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h40v40H0z' fill='none'/%3E%3Cpath d='M0 0v10h2v-8h8v-2H0zm30 0v2h8v8h2V0h-10zM0 30v10h10v-2H2v-8H0zm40 10v-10h-2v8h-8v2h10z' fill='%23C23E3E' opacity='0.6'/%3E%3Cpath d='M5 5h10v2H5zm25 0h-10v2h10zm0 30h-10v-2h10zM5 35h10v-2H5z' fill='%23C23E3E' opacity='0.3'/%3E%3C/svg%3E");
  
  /* Border Pattern - Updated to use the new softer red */
  --cf-border-pattern: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h20v20H0z' fill='none'/%3E%3Cpath d='M9 0h2v20H9zM0 9h20v2H0z' fill='%23C23E3E' opacity='0.08'/%3E%3Crect x='8' y='8' width='4' height='4' fill='%23E6B800' opacity='0.2'/%3E%3C/svg%3E");

  --cf-svg-window-grille: url("/src/assets/窗花-红-右上.svg");
  --cf-svg-ink-circle: url("/src/assets/墨圈.svg");
  --cf-doc-title-icon: url("/src/assets/竹简.svg");
}

body {
  background-color: var(--cf-color-bg);
  background-image: var(--cf-bg-pattern);
  background-size: var(--cf-bg-size, auto);
  background-attachment: fixed;
  color: var(--cf-color-text);
  font-family: var(--cf-font-family);
  transition: var(--cf-transition);
  margin: 0;
  min-height: 100vh;
}

/* Decorative corner utility */
.cf-decor-corner {
  position: absolute;
  width: 28px;
  height: 28px;
  background-image: var(--cf-svg-window-grille);
  background-size: contain;
  background-repeat: no-repeat;
  pointer-events: none;
}
.cf-decor-corner.tr { top: -2px; right: -2px; transform: none; }
.cf-decor-corner.tl { top: -2px; left: -2px; transform: rotate(-90deg); }
.cf-decor-corner.bl { bottom: -2px; left: -2px; transform: rotate(180deg); }
.cf-decor-corner.br { bottom: -2px; right: -2px; transform: rotate(90deg); }

/* Suya: black-white grille asset is base oriented at bottom-left */
[data-theme="suya"] .cf-decor-corner.bl { transform: none; }
[data-theme="suya"] .cf-decor-corner.tr { transform: rotate(180deg); }

/* Themed Scrollbars */
[data-theme="suya"] ::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
[data-theme="suya"] ::-webkit-scrollbar-track {
  background: rgba(74, 106, 116, 0.06);
  border-radius: 4px;
}
[data-theme="suya"] ::-webkit-scrollbar-thumb {
  background: rgba(74, 106, 116, 0.35);
  border-radius: 4px;
}
[data-theme="suya"] ::-webkit-scrollbar-thumb:hover {
  background: rgba(74, 106, 116, 0.5);
}

[data-theme="huali"] ::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
[data-theme="huali"] ::-webkit-scrollbar-track {
  background: rgba(194, 62, 62, 0.08);
  border-radius: 4px;
}
[data-theme="huali"] ::-webkit-scrollbar-thumb {
  background: rgba(194, 62, 62, 0.45);
  border-radius: 4px;
  box-shadow: inset 0 0 2px rgba(255,255,255,0.4);
}
[data-theme="huali"] ::-webkit-scrollbar-thumb:hover {
  background: rgba(194, 62, 62, 0.6);
}

/* Global Transitions */
.fade-enter-active, .fade-leave-active {
  transition: opacity 0.25s ease, transform 0.25s ease;
}
.fade-enter-from, .fade-leave-to {
  opacity: 0;
  transform: translateY(6px);
}

.slide-up-enter-active, .slide-up-leave-active {
  transition: opacity 0.25s ease, transform 0.3s cubic-bezier(0.22, 1, 0.36, 1);
}
.slide-up-enter-from, .slide-up-leave-to {
  opacity: 0;
  transform: translateY(10px);
}

.slide-down-enter-active, .slide-down-leave-active {
  transition: opacity 0.25s ease, transform 0.3s cubic-bezier(0.22, 1, 0.36, 1);
}
.slide-down-enter-from, .slide-down-leave-to {
  opacity: 0;
  transform: translateY(-10px);
}

.slide-left-enter-active, .slide-left-leave-active,
.slide-right-enter-active, .slide-right-leave-active {
  transition: opacity 0.25s ease, transform 0.3s cubic-bezier(0.22, 1, 0.36, 1);
}
.slide-left-enter-from, .slide-left-leave-to {
  opacity: 0;
  transform: translateX(-12px);
}
.slide-right-enter-from, .slide-right-leave-to {
  opacity: 0;
  transform: translateX(12px);
}

/* Screen Switch Transition */
.screen-switch-enter-active, .screen-switch-leave-active {
  transition: opacity 260ms ease, transform 320ms cubic-bezier(0.22, 1, 0.36, 1);
}
.screen-switch-enter-from, .screen-switch-leave-to {
  opacity: 0;
  transform: translateY(12px) scale(0.98);
}

/* Close Pop Transition */
.close-pop-enter-active, .close-pop-leave-active {
  transition: opacity 180ms ease, transform 220ms ease;
}
.close-pop-enter-from, .close-pop-leave-to {
  opacity: 0;
  transform: scale(0.92);
}

/* Loader Animations */
@keyframes ink-ripple {
  0% { box-shadow: 0 0 0 0 rgba(74,106,116,0.35); }
  70% { box-shadow: 0 0 0 14px rgba(74,106,116,0.0); }
  100% { box-shadow: 0 0 0 0 rgba(74,106,116,0.0); }
}
@keyframes red-pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.08); }
  100% { transform: scale(1); }
}
@keyframes rotate-slow {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Theme Transition Overlay */
.theme-trans {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 99999;
}
.theme-trans__glass {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.08);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
}
.theme-trans__curtain {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 0;
  transform-origin: top;
  animation: curtain-down 900ms ease forwards;
}
.theme-trans__poem {
  position: relative;
  color: #111;
  font-family: var(--cf-font-family);
  font-size: 20px;
  text-align: center;
  line-height: 1.8;
  padding: 0 24px;
  max-width: 800px;
}
.theme-trans__progress {
  margin-top: 16px;
  width: 60%;
  max-width: 720px;
  height: 8px;
  border-radius: 8px;
  overflow: hidden;
  position: relative;
}
.theme-trans__bar {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 0%;
}
.theme-trans__icon {
  position: absolute;
  top: -18px;
  left: 0;
  width: 36px;
  height: 36px;
  object-fit: contain;
}
.theme-trans--to-suya .theme-trans__curtain {
  background: linear-gradient(180deg, rgba(44,62,80,0.20), rgba(44,62,80,0.45));
}
.theme-trans--to-suya .theme-trans__glass {
  background: rgba(44,62,80,0.12);
}
.theme-trans--to-suya .theme-trans__poem {
  color: #111;
}
.theme-trans--to-suya .theme-trans__progress {
  background: rgba(0,0,0,0.1);
}
.theme-trans--to-suya .theme-trans__bar {
  background: linear-gradient(90deg, rgba(0,0,0,0.5), rgba(0,0,0,0.8));
}
.theme-trans--to-suya .theme-trans__icon {
  filter: grayscale(100%) brightness(0.25);
}
.theme-trans--to-huali .theme-trans__curtain {
  background: linear-gradient(180deg, rgba(194,62,62,0.18), rgba(194,62,62,0.40));
}
.theme-trans--to-huali .theme-trans__glass {
  background: rgba(194,62,62,0.10);
}
.theme-trans--to-huali .theme-trans__poem {
  color: #4A1F1F;
}
.theme-trans--to-huali .theme-trans__progress {
  background: rgba(194,62,62,0.12);
}
.theme-trans--to-huali .theme-trans__bar {
  background: linear-gradient(90deg, rgba(194,62,62,0.5), rgba(194,62,62,0.85));
}
.theme-trans--to-huali .theme-trans__icon {
  filter: sepia(100%) saturate(600%) hue-rotate(-10deg) brightness(1);
}

@keyframes curtain-down {
  0% { height: 0; }
  100% { height: 100vh; }
}
